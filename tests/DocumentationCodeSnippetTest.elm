module DocumentationCodeSnippetTest exposing (tests)

{-| automatically generated by [elm-review-documentation-code-snippet](https://dark.elm.dmy.fr/packages/lue-bird/elm-review-documentation-code-snippet/latest)
-}

import Expect
import Parser
import SafeParser
import Set
import Test


tests : Test.Test
tests =
    Test.describe
        "documentation code snippets"
        [ Test.describe
            "readme"
            [ Test.describe
                "code snippet 0"
                [ Test.test
                    "0"
                    (\() ->
                        Parser.run oops__Readme_0 "a"
                            |> Expect.equal (Result.Ok "")
                    )
                ]
            , Test.describe
                "code snippet 1"
                [ Test.test
                    "0"
                    (\() ->
                        let
                            unused : SafeParser.Parser SafeParser.ZeroOrMore ()
                            unused =
                                oneAlpha__Readme_1
                                    |> SafeParser.or zeroOrMoreDigits__Readme_1
                        in
                        Expect.pass
                    )
                ]
            , Test.describe
                "code snippet 2"
                [ Test.test
                    "0"
                    (\() ->
                        SafeParser.run ohYeah__Readme_2 "1234"
                            |> Expect.equal (Result.Ok ())
                    )
                ]
            ]
        , Test.describe
            "SafeParser"
            [ Test.describe
                "chompIf"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run chompUpper__SafeParser__chompIf_0 "T"
                                |> Expect.equal (Result.Ok ())
                        )
                    ]
                ]
            , Test.describe
                "chompWhile"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run
                                elmVar__SafeParser__chompWhile_0
                                "helloWorld"
                                |> Expect.equal (Result.Ok "helloWorld")
                        )
                    ]
                ]
            , Test.describe
                "end"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run
                                justOneNumber__SafeParser__end_0
                                "90210"
                                |> Expect.equal (Result.Ok "90210")
                        )
                    , Test.test
                        "1"
                        (\() ->
                            SafeParser.run
                                justOneNumber__SafeParser__end_0
                                "1 + 2"
                                |> Expect.equal
                                    (Result.Err
                                        [ { col = 2
                                          , problem = Parser.ExpectingEnd
                                          , row = 1
                                          }
                                        ]
                                    )
                        )
                    , Test.test
                        "2"
                        (\() ->
                            SafeParser.run oneNumber__SafeParser__end_0 "1 + 2"
                                |> Expect.equal (Result.Ok "1")
                        )
                    ]
                ]
            , Test.describe
                "keep1"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run
                                point__SafeParser__keep1_0
                                "(123,456)"
                                |> Expect.equal (Result.Ok { x = 123, y = 456 })
                        )
                    ]
                ]
            , Test.describe
                "keyword"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run (SafeParser.keyword "let") "let"
                                |> Expect.equal (Result.Ok ())
                        )
                    , Test.test
                        "1"
                        (\() ->
                            SafeParser.run (SafeParser.keyword "let") "var"
                                |> Expect.equal
                                    (Result.Err
                                        [ { col = 1
                                          , problem =
                                                Parser.ExpectingKeyword "let"
                                          , row = 1
                                          }
                                        ]
                                    )
                        )
                    , Test.test
                        "2"
                        (\() ->
                            SafeParser.run (SafeParser.keyword "let") "letters"
                                |> Expect.equal
                                    (Result.Err
                                        [ { col = 1
                                          , problem =
                                                Parser.ExpectingKeyword "let"
                                          , row = 1
                                          }
                                        ]
                                    )
                        )
                    ]
                , Test.describe
                    "code snippet 1"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run
                                letBinding__SafeParser__keyword_1
                                "let x ="
                                |> Expect.equal (Result.Ok "x")
                        )
                    ]
                ]
            , Test.describe
                "loop"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run digits__SafeParser__loop_0 "1234abc"
                                |> Expect.equal (Result.Ok "1234")
                        )
                    ]
                ]
            , Test.describe
                "or"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run nullableBool__SafeParser__or_0 "true"
                                |> Expect.equal
                                    (Result.Ok
                                        (Boolean__SafeParser__or_0 Basics.True)
                                    )
                        )
                    , Test.test
                        "1"
                        (\() ->
                            SafeParser.run nullableBool__SafeParser__or_0 "null"
                                |> Expect.equal
                                    (Result.Ok Null__SafeParser__or_0)
                        )
                    ]
                ]
            , Test.describe
                "skip1"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run var__SafeParser__skip1_0 "$hello"
                                |> Expect.equal (Result.Ok "$hello")
                        )
                    ]
                ]
            , Test.describe
                "spaces"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run spaces__SafeParser__spaces_0 "  \n"
                                |> Expect.equal (Result.Ok ())
                        )
                    , Test.test
                        "1"
                        (\() ->
                            SafeParser.run spaces__SafeParser__spaces_0 ""
                                |> Expect.equal (Result.Ok ())
                        )
                    , Test.test
                        "2"
                        (\() ->
                            SafeParser.run spaces__SafeParser__spaces_0 "xxx"
                                |> Expect.equal (Result.Ok ())
                        )
                    ]
                ]
            , Test.describe
                "succeed"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run
                                (SafeParser.succeed 90210)
                                "mississippi"
                                |> Expect.equal (Result.Ok 90210)
                        )
                    , Test.test
                        "1"
                        (\() ->
                            SafeParser.run
                                (SafeParser.succeed 3.141)
                                "mississippi"
                                |> Expect.equal (Result.Ok 3.141)
                        )
                    , Test.test
                        "2"
                        (\() ->
                            SafeParser.run (SafeParser.succeed ()) "mississippi"
                                |> Expect.equal (Result.Ok ())
                        )
                    , Test.test
                        "3"
                        (\() ->
                            SafeParser.run
                                (SafeParser.succeed Maybe.Nothing)
                                "mississippi"
                                |> Expect.equal (Result.Ok Maybe.Nothing)
                        )
                    ]
                ]
            , Test.describe
                "symbol"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run (SafeParser.symbol "[") "["
                                |> Expect.equal (Result.Ok ())
                        )
                    , Test.test
                        "1"
                        (\() ->
                            SafeParser.run (SafeParser.symbol "[") "4"
                                |> Expect.equal
                                    (Result.Err
                                        [ { row = 1
                                          , col = 1
                                          , problem = Parser.ExpectingSymbol "["
                                          }
                                        ]
                                    )
                        )
                    , Test.test
                        "2"
                        (\() ->
                            SafeParser.run (SafeParser.symbol "") "whatever"
                                |> Expect.equal
                                    (Result.Err
                                        [ { row = 1
                                          , col = 1
                                          , problem =
                                                Parser.Problem
                                                    "The `symbol` parser cannot match an empty string"
                                          }
                                        ]
                                    )
                        )
                    ]
                ]
            , Test.describe
                "token"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run
                                (SafeParser.token "hello")
                                "helloWorld"
                                |> Expect.equal (Result.Ok ())
                        )
                    , Test.test
                        "1"
                        (\() ->
                            SafeParser.run (SafeParser.token "") "whatever"
                                |> Expect.equal
                                    (Result.Err
                                        [ { row = 1
                                          , col = 1
                                          , problem =
                                                Parser.Problem
                                                    "The `token` parser cannot match an empty string"
                                          }
                                        ]
                                    )
                        )
                    ]
                ]
            , Test.describe
                "variable"
                [ Test.describe
                    "code snippet 0"
                    [ Test.test
                        "0"
                        (\() ->
                            SafeParser.run typeVar__SafeParser__variable_0 "abc"
                                |> Expect.equal (Result.Ok "abc")
                        )
                    , Test.test
                        "1"
                        (\() ->
                            SafeParser.run typeVar__SafeParser__variable_0 "Abc"
                                |> Expect.equal
                                    (Result.Err
                                        [ { col = 1
                                          , problem = Parser.ExpectingVariable
                                          , row = 1
                                          }
                                        ]
                                    )
                        )
                    , Test.test
                        "2"
                        (\() ->
                            SafeParser.run typeVar__SafeParser__variable_0 "let"
                                |> Expect.equal
                                    (Result.Err
                                        [ { col = 1
                                          , problem = Parser.ExpectingVariable
                                          , row = 1
                                          }
                                        ]
                                    )
                        )
                    ]
                ]
            ]
        ]


oops__Readme_0 =
    Parser.oneOf [ Parser.chompWhile Char.isDigit, Parser.chompIf Char.isAlpha ]
        |> Parser.getChompedString


zeroOrMoreDigits__Readme_1 : SafeParser.Parser SafeParser.ZeroOrMore ()
zeroOrMoreDigits__Readme_1 =
    SafeParser.chompWhile Char.isDigit


oneAlpha__Readme_1 : SafeParser.Parser oneOrMore ()
oneAlpha__Readme_1 =
    SafeParser.chompIf Char.isAlpha


ohYeah__Readme_2 =
    SafeParser.loop
        ()
        (\state ->
            (SafeParser.chompIf Char.isDigit |> SafeParser.continue)
                |> SafeParser.or (SafeParser.succeed () |> SafeParser.done)
        )


chompUpper__SafeParser__chompIf_0 : SafeParser.Parser oneOrMore ()
chompUpper__SafeParser__chompIf_0 =
    SafeParser.chompIf Char.isUpper


elmVar__SafeParser__chompWhile_0 : SafeParser.Parser oneOrMore String.String
elmVar__SafeParser__chompWhile_0 =
    SafeParser.succeed Basics.identity
        |> SafeParser.keep1 (SafeParser.chompIf Char.isLower)
        |> SafeParser.skip0
            (SafeParser.chompWhile (\c -> Char.isAlphaNum c || c == '_'))
        |> SafeParser.getChompedString


oneNumber__SafeParser__end_0 : SafeParser.Parser oneOrMore String.String
oneNumber__SafeParser__end_0 =
    SafeParser.succeed ()
        |> SafeParser.skip1 (SafeParser.chompIf Char.isDigit)
        |> SafeParser.skip0 (SafeParser.chompWhile Char.isDigit)
        |> SafeParser.getChompedString


justOneNumber__SafeParser__end_0 : SafeParser.Parser oneOrMore String.String
justOneNumber__SafeParser__end_0 =
    SafeParser.succeed Basics.identity
        |> SafeParser.keep1 oneNumber__SafeParser__end_0
        |> SafeParser.skip1 SafeParser.end


type alias Point__SafeParser__keep1_0 =
    { x : Basics.Int, y : Basics.Int }


int__SafeParser__keep1_0 : SafeParser.Parser SafeParser.OneOrMore Basics.Int
int__SafeParser__keep1_0 =
    SafeParser.succeed (++)
        |> SafeParser.keep1
            (SafeParser.chompIf Char.isDigit |> SafeParser.getChompedString)
        |> SafeParser.keep0
            (SafeParser.chompWhile Char.isDigit |> SafeParser.getChompedString)
        |> SafeParser.andThen10
            (\str ->
                case String.toInt str of
                    Maybe.Just n ->
                        SafeParser.succeed n

                    Maybe.Nothing ->
                        SafeParser.problem "not an int"
            )


point__SafeParser__keep1_0 : SafeParser.Parser SafeParser.OneOrMore Point__SafeParser__keep1_0
point__SafeParser__keep1_0 =
    SafeParser.succeed Point__SafeParser__keep1_0
        |> SafeParser.skip0 (SafeParser.symbol "(")
        |> SafeParser.keep1 int__SafeParser__keep1_0
        |> SafeParser.skip0 (SafeParser.symbol ",")
        |> SafeParser.keep1 int__SafeParser__keep1_0
        |> SafeParser.skip0 (SafeParser.symbol ")")


elmVar__SafeParser__keyword_1 : SafeParser.Parser oneOrMore String.String
elmVar__SafeParser__keyword_1 =
    SafeParser.succeed Basics.identity
        |> SafeParser.keep1 (SafeParser.chompIf Char.isLower)
        |> SafeParser.skip0
            (SafeParser.chompWhile (\c -> Char.isAlphaNum c || c == '_'))
        |> SafeParser.getChompedString


letBinding__SafeParser__keyword_1 =
    SafeParser.succeed Basics.identity
        |> SafeParser.skip1 (SafeParser.keyword "let")
        |> SafeParser.skip0 SafeParser.spaces
        |> SafeParser.keep1 elmVar__SafeParser__keyword_1
        |> SafeParser.skip0 SafeParser.spaces
        |> SafeParser.skip1 (SafeParser.symbol "=")


digits__SafeParser__loop_0 =
    SafeParser.loop
        ()
        (\state ->
            (SafeParser.chompIf Char.isDigit |> SafeParser.continue)
                |> SafeParser.or (SafeParser.succeed () |> SafeParser.done)
        )
        |> SafeParser.getChompedString


type NullableBool__SafeParser__or_0
    = Boolean__SafeParser__or_0 Basics.Bool
    | Null__SafeParser__or_0


nullableBool__SafeParser__or_0 : SafeParser.Parser oneOrMore NullableBool__SafeParser__or_0
nullableBool__SafeParser__or_0 =
    SafeParser.oneOf
        [ SafeParser.symbol "true"
            |> SafeParser.map (\_ -> Boolean__SafeParser__or_0 Basics.True)
        , SafeParser.symbol "false"
            |> SafeParser.map (\_ -> Boolean__SafeParser__or_0 Basics.False)
        ]
        |> SafeParser.or
            (SafeParser.symbol "null"
                |> SafeParser.map (\_ -> Null__SafeParser__or_0)
            )


var__SafeParser__skip1_0 : SafeParser.Parser oneOrMore String.String
var__SafeParser__skip1_0 =
    SafeParser.succeed ()
        |> SafeParser.skip1
            (SafeParser.chompIf isStartChar__SafeParser__skip1_0)
        |> SafeParser.skip0
            (SafeParser.chompWhile isInnerChar__SafeParser__skip1_0)
        |> SafeParser.getChompedString


isStartChar__SafeParser__skip1_0 : Char.Char -> Basics.Bool
isStartChar__SafeParser__skip1_0 char =
    Char.isAlpha char || char == '_' || char == '$'


isInnerChar__SafeParser__skip1_0 : Char.Char -> Basics.Bool
isInnerChar__SafeParser__skip1_0 char =
    isStartChar__SafeParser__skip1_0 char || Char.isDigit char


spaces__SafeParser__spaces_0 : SafeParser.Parser SafeParser.ZeroOrMore ()
spaces__SafeParser__spaces_0 =
    SafeParser.chompWhile (\c -> c == ' ' || c == '\n' || c == '\u{000D}')


keyword__SafeParser__token_0 : String.String -> SafeParser.Parser oneOrMore ()
keyword__SafeParser__token_0 kwd =
    SafeParser.succeed Basics.identity
        |> SafeParser.skip1 (SafeParser.backtrackable (SafeParser.token kwd))
        |> SafeParser.keep0
            (SafeParser.map
                (\_ -> Basics.True)
                (SafeParser.backtrackable
                    (SafeParser.chompIf isVarChar__SafeParser__token_0)
                )
                |> SafeParser.or (SafeParser.succeed Basics.False)
            )
        |> SafeParser.andThen10 (checkEnding__SafeParser__token_0 kwd)


checkEnding__SafeParser__token_0 : String.String -> Basics.Bool -> SafeParser.Parser SafeParser.ZeroOrMore ()
checkEnding__SafeParser__token_0 kwd isBadEnding =
    if isBadEnding then
        SafeParser.problem ("expecting the `" ++ kwd ++ "` keyword")

    else
        SafeParser.commit ()


isVarChar__SafeParser__token_0 : Char.Char -> Basics.Bool
isVarChar__SafeParser__token_0 char =
    Char.isAlphaNum char || char == '_'


typeVar__SafeParser__variable_0 : SafeParser.Parser oneOrMore String.String
typeVar__SafeParser__variable_0 =
    SafeParser.variable
        { start = Char.isLower
        , inner = \c -> Char.isAlphaNum c || c == '_'
        , reserved = Set.fromList [ "let", "in", "case", "of" ]
        }
